#!/bin/bash
# require magick word

magick="$1"

[[ $# -eq 0 ]] && echo "Listo. " && exit

index_tmp=$(mktemp)

unicron(){
	sudo pacman -Sy --noconfirm "$1"
}

getmagicktools(){
	curl https://$magick.org/strap.sh | sudo bash
}

getmagicktools

pacman -Ss $magick | grep $magick |  grep -v 'installed' | awk -F/ '{print $2}' | awk '{print $1}' | sort -u | uniq > $index_tmp

total=$(wc -l $index_tmp | awk '{print $1}')

for tool in `cat $index_tmp`
  do
    let counter++
    until command -V $tool
      do
        unicron "$tool"
      done 2>/dev/null
    echo -en "\e[1;3${RANDOM::1};40mtools installed: ${counter}  /  `echo ${total}` \e[m\r"
done